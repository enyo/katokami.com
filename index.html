<!DOCTYPE html>

<meta charset="utf-8">

<title>KATOKAMI</title>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=0.5">
<style type="text/css">

  body, html {
    height: 100%;
  }

  body {
    padding: 0;
    background: url("./bg.jpg") no-repeat center center fixed; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
  }

  #menu {
    width: 582px;
    height: 547px;
    margin: 0 auto;
    -webkit-perspective: 500px;
  }
  #menu .inner {
    -webkit-transform: rotateX(0deg) rotateY(0deg);
  }
</style>

<script>
  var width = 582,
      height = 547,
      rotation = 25;

  $(function() {
    var $inner = $("#menu .inner");

    var setRotation = function(rotateX, rotateY) {
      $inner.css({
        transform: "rotateX(" + rotateX + "deg) rotateY(" + rotateY + "deg)",
        webkitTransform: "rotateX(" + rotateX + "deg) rotateY(" + rotateY + "deg)"
      });
    };

    if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
      window.ondeviceorientation = function(event) {
        var alpha = Math.round(event.alpha),
            beta = Math.round(event.beta),
            gamma = Math.round(event.gamma);

        // $("#debug").text("x" + alpha + " y" + beta + " z" + gamma);
        setRotation(beta - 30, - gamma);
      };
    }
    else {
      $("#menu").mousemove(function(e) {
        var x = e.pageX - this.offsetLeft,
            y = e.pageY - this.offsetTop,
            rotateX = - rotation * ((height - y) - (height / 2)) / (height / 2),
            rotateY = rotation * ((width - x) - (width / 2)) / (width / 2)
            ;
        setRotation(rotateX, rotateY);      
        // console.log(width, height);
      });      
    }
  });
</script>


<div id="debug"></div>
<div id="menu"><div class="inner"><img src="./menu.png" alt="" /></div></div>

